(this["webpackJsonptodo-list-in-browser"]=this["webpackJsonptodo-list-in-browser"]||[]).push([[0],{12:function(e,t,n){e.exports=n(19)},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(10),a=n(1),o=n.n(a),c=n(5),u=n(2),l=n(0),i=n.n(l),s=n(9),m=n(8),d=n.n(m);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(18);var f=n(6),p=function(){var e;return null!==(e=window.localStorage.getItem("text"))&&void 0!==e?e:""},v=function(){var e;return JSON.parse(null!==(e=window.localStorage.getItem("completed_items"))&&void 0!==e?e:"[]")},w=p(),h=v(),x=i.a.createContext({onSave:null,text:null,setText:null,completedItems:null,setCompletedItems:null,isSaved:null,setIsSaved:null,reloadFromDatabase:null,undo:null,canUndo:null}),b=function(e){var t=e.children,n=i.a.useState(),r=Object(u.a)(n,2),a=r[0],l=r[1],s=i.a.useState({text:w,completedItems:h}),m=Object(u.a)(s,2),d=m[0],b=m[1],I=d.text,k=d.completedItems,S=i.a.useState(!0),g=Object(u.a)(S,2),E=g[0],C=g[1],y=i.a.useRef([d]),O=y.current[y.current.length-1];O.text===d.text&&O.completedItems===d.completedItems||y.current.push(d);console.log(y.current);var j=i.a.useCallback((function(){return b({text:p(),completedItems:v()})}),[]),F=i.a.useCallback(Object(c.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.localStorage.setItem("text",I),window.localStorage.setItem("completed_items",JSON.stringify(k)),C(!0),t=a){e.next=9;break}return e.next=7,window.chooseFileSystemEntries({type:"save-file"});case 7:t=e.sent,l(t);case 9:return e.next=11,t.createWritable();case 11:return n=e.sent,e.next=14,n.write({type:"write",data:I});case 14:return e.next=16,n.close();case 16:case"end":return e.stop()}}),e)}))),[I,k,a]),D=i.a.useRef(!0);i.a.useEffect((function(){D.current?D.current=!1:C(window.localStorage.getItem("text")===I)}),[I]);var M={onSave:F,text:I,setText:function(e){return b((function(t){return Object(f.a)({},t,{text:e})}))},completedItems:k,setCompletedItems:function(e){return b((function(t){return Object(f.a)({},t,{completedItems:e(t.completedItems)})}))},isSaved:E,setIsSaved:C,reloadFromDatabase:j,undo:function(){y.current.pop(),b(y.current[y.current.length-1])},canUndo:y.current.length>1};return i.a.createElement(x.Provider,{value:M},t)},I=function(){return i.a.useContext(x)},k=function(e){var t=e.onShowCompletedItems,n=e.showCompletedItems,r=I(),a=r.onSave,o=r.isSaved,c=r.reloadFromDatabase,u=r.undo,l=r.canUndo;return i.a.createElement("nav",null,l&&i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{onClick:u},"Undo")," "),i.a.createElement("button",{onClick:a},"Save (^S)")," ",o?"":"(not saved)"," ",i.a.createElement("button",{onClick:function(){return t((function(e){return!e}))}},n?"Hide completed items":"Show completed items")," ",!o&&i.a.createElement("button",{onClick:c},"Reload from local storage"))},S=n(11),g=function(e){var t=e.items,n=e.onCheckboxCheck,r=e.checked,a=Object(S.a)(e,["items","onCheckboxCheck","checked"]);return 0===t.length?i.a.createElement("div",null,"Empty"):i.a.createElement("ul",a,t.filter((function(e){return e.item.length>0})).map((function(e){var t=e.item,a=e.rawItem,o=e.index;return i.a.createElement("li",null,i.a.createElement("input",{type:"checkbox",checked:r,onChange:function(){return n({item:t,rawItem:a,index:o})}})," ",t)})))},E=window.document.title,C=function(){var e=I(),t=e.onSave,n=e.isSaved,a=e.text,l=e.setText,m=e.setCompletedItems,d=e.completedItems,f=i.a.useState(!1),p=Object(u.a)(f,2),v=p[0],w=p[1],h=i.a.useRef();i.a.useEffect((function(){var e=h.current,n=function(){var e=Object(c.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==n.ctrlKey&&!0!==n.metaKey||"s"!==n.key){e.next=4;break}return n.preventDefault(),e.next=4,t();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return e.addEventListener("keydown",n),function(){return e.removeEventListener("keydown",n)}}),[t]),i.a.useEffect((function(){window.document.title=n?E:"* ".concat(E)}),[n]);var x=a.split(/(?:^|\n)-/).map((function(e,t){return{rawItem:e,item:e.replace(/(^[\n\s]+)|([\n\s]+$)/g,""),index:t}}));return i.a.createElement("div",null,i.a.createElement(k,{onShowCompletedItems:function(){return w((function(e){return!e}))},showCompletedItems:v}),i.a.createElement("textarea",{ref:h,autoFocus:!0,value:a,onChange:function(e){return l(e.target.value)}}),i.a.createElement(g,{id:"list",checked:!1,items:x.filter((function(e){return e.item.length>0})),onCheckboxCheck:function(e){var t=e.item,n=e.rawItem,a=e.index;m((function(e){return[].concat(Object(r.a)(e),[{rawItem:n,item:t,date:Object(s.a)(new Date,"yyyy-MM-dd HH:MM")}])})),l(x.filter((function(e,t){return t!==a})).map((function(e){return e.rawItem})).join("-"))}}),v&&i.a.createElement(g,{id:"completed",checked:!0,items:d,onCheckboxCheck:function(e){e.item;var t=e.rawItem,n=e.index;m((function(e){return e.filter((function(e,t){return t!==n}))})),l((function(e){return"".concat(e.replace(/\n$/,""),"\n-").concat(t)}))}}))};d.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(b,null,i.a.createElement(C,null))),window.document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[12,1,2]]]);
//# sourceMappingURL=main.b5f63b25.chunk.js.map