(this["webpackJsonptodo-list-in-browser"]=this["webpackJsonptodo-list-in-browser"]||[]).push([[0],{12:function(e,t,n){e.exports=n(19)},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(10),a=n(1),o=n.n(a),c=n(5),u=n(2),i=n(0),l=n.n(i),s=n(9),d=n(8),m=n.n(d);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(18);var f=n(6),p=function(e){return e&&("[object Function]"===Object.prototype.toString.call(e)||"function"===typeof e||e instanceof Function)},v=function(){var e;return null!==(e=window.localStorage.getItem("text"))&&void 0!==e?e:""},w=function(){var e;return JSON.parse(null!==(e=window.localStorage.getItem("completed_items"))&&void 0!==e?e:"[]")},h=v(),x=w(),b=l.a.createContext({onSave:null,text:null,setText:null,completedItems:null,setCompletedItems:null,isSaved:null,setIsSaved:null,reloadFromDatabase:null,undo:null,canUndo:null}),k=function(e){var t=e.children,n=l.a.useState(),r=Object(u.a)(n,2),a=r[0],i=r[1],s=l.a.useState({text:h,completedItems:x}),d=Object(u.a)(s,2),m=d[0],k=d[1],g=m.text,S=m.completedItems,E=l.a.useState(!0),C=Object(u.a)(E,2),I=C[0],y=C[1],j=l.a.useRef([m]),O=j.current[j.current.length-1];O.text===m.text&&O.completedItems===m.completedItems||j.current.push(m);var L=l.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{updateText:!0},t=e.updateText,n=void 0===t||t;j.current.length<2||(j.current.pop(),n&&k(j.current[j.current.length-1]))}),[]),F=l.a.useCallback((function(){return k({text:v(),completedItems:w()})}),[]),T=l.a.useCallback(Object(c.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.localStorage.setItem("text",g),window.localStorage.setItem("completed_items",JSON.stringify(S)),y(!0),t=a){e.next=9;break}return e.next=7,window.chooseFileSystemEntries({type:"save-file"});case 7:t=e.sent,i(t);case 9:return e.next=11,t.createWritable();case 11:return n=e.sent,e.next=14,n.write({type:"write",data:g});case 14:return e.next=16,n.close();case 16:case"end":return e.stop()}}),e)}))),[g,S,a]),D=l.a.useRef(!0);l.a.useEffect((function(){D.current?D.current=!1:y(window.localStorage.getItem("text")===g)}),[g]);var M={onSave:T,text:g,setText:function(e){return k((function(t){return Object(f.a)({},t,{text:p(e)?e(g):e})}))},completedItems:S,setCompletedItems:function(e){return k((function(t){return Object(f.a)({},t,{completedItems:p(e)?e(t.completedItems):e})}))},isSaved:I,setIsSaved:y,reloadFromDatabase:F,undo:L,canUndo:j.current.length>1};return l.a.createElement(b.Provider,{value:M},t)},g=function(){return l.a.useContext(b)},S=function(e){var t=e.onShowCompletedItems,n=e.showCompletedItems,r=g(),a=r.onSave,o=r.isSaved,c=r.reloadFromDatabase,u=r.undo,i=r.canUndo;return l.a.createElement("nav",null,i&&l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{onClick:u},"Undo")," "),l.a.createElement("button",{onClick:a},"Save (^S)")," ",o?"":"(not saved)"," ",l.a.createElement("button",{onClick:function(){return t((function(e){return!e}))}},n?"Hide completed items":"Show completed items")," ",!o&&l.a.createElement("button",{onClick:c},"Reload from local storage"))},E=n(11),C=function(e){var t=e.items,n=e.onCheckboxCheck,r=e.checked,a=e.render,o=Object(E.a)(e,["items","onCheckboxCheck","checked","render"]);return 0===t.length?l.a.createElement("div",null,"Empty"):l.a.createElement("ul",o,t.map((function(e,t){return l.a.createElement("li",{key:e.index||t},l.a.createElement("input",{type:"checkbox",checked:r,onChange:function(){return n(e,t)}})," ",a(e))})))},I=window.document.title,y=function(){var e=g(),t=e.onSave,n=e.isSaved,a=e.text,i=e.setText,d=e.setCompletedItems,m=e.completedItems,f=e.undo,p=l.a.useState(!1),v=Object(u.a)(p,2),w=v[0],h=v[1],x=l.a.useRef();l.a.useEffect((function(){var e=x.current,n=function(){var e=Object(c.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==n.ctrlKey&&!0!==n.metaKey||"s"!==n.key){e.next=4;break}return n.preventDefault(),e.next=4,t();case 4:!0!==n.ctrlKey&&!0!==n.metaKey||"z"!==n.key||(n.stopPropagation(),f({updateText:!1}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return e.addEventListener("keydown",n),function(){return e.removeEventListener("keydown",n)}}),[t,f]),l.a.useEffect((function(){window.document.title=n?I:"* ".concat(I)}),[n]);var b=a.split("\n").map((function(e,t){return{rawLine:e,index:t}})),k=b.filter((function(e){return e.rawLine.match(/^\s*-/)})).map((function(e){var t=e.rawLine;return{rawLine:t,index:e.index,line:t.replace(/^\s*-\s*/g,"")}})).filter((function(e){return e.line.length>0}));return l.a.createElement("div",null,l.a.createElement(S,{onShowCompletedItems:function(){return h((function(e){return!e}))},showCompletedItems:w}),l.a.createElement("textarea",{ref:x,autoFocus:!0,value:a,onChange:function(e){return i(e.target.value)}}),l.a.createElement(C,{render:function(e){return e.line},id:"list",checked:!1,items:k,onCheckboxCheck:function(e){var t=e.line,n=e.rawLine,a=e.index;d((function(e){return[].concat(Object(r.a)(e),[{rawLine:n,line:t,date:Object(s.a)(new Date,"yyyy-MM-dd HH:MM")}])})),i(b.filter((function(e,t){return t!==a})).map((function(e){return e.rawLine})).join("\n"))}}),w&&l.a.createElement(C,{render:function(e){var t=e.line,n=e.date;return"".concat(t," (on ").concat(n,")")},id:"completed",checked:!0,items:m,onCheckboxCheck:function(e,t){var n=e.rawLine;d((function(e){return e.filter((function(e,n){return n!==t}))})),i((function(e){return"".concat(n,"\n").concat(e)}))}}))};m.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(k,null,l.a.createElement(y,null))),window.document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[12,1,2]]]);
//# sourceMappingURL=main.f213f1eb.chunk.js.map